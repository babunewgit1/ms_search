<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="ms_popup_box">
      <div class="container">
        <div class="ms_popup_header">
          <div class="msp_header_icon">
            <img
              src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/6929904e2a85631be7392ee2_ms_cross.png"
              alt="cross_icon"
            />
          </div>
          <h3>Edit <span>YOUR SEARCH</span></h3>
        </div>
        <div class="ms_pop_tab_box">
          <div class="ms_tab_header">
            <div class="ms_tab_item" data-item="mstaboneway">
              <p>One Way</p>
            </div>
            <div class="ms_tab_item" data-item="mstabroundtrip">
              <p>Round Trip</p>
            </div>
            <div class="ms_tab_item" data-item="mstabmulticity">
              <p>Multi-city</p>
            </div>
          </div>
          <div class="ms_tab_cnt_wrapper">
            <div class="ms_tab_cnt_item" id="mstaboneway">
              <div id="onewayContainer">one way</div>
            </div>
            <div class="ms_tab_cnt_item" id="mstabroundtrip">
              <div id="roundtripContainer">round trip</div>
            </div>
            <div class="ms_tab_cnt_item" id="mstabmulticity">
              <div id="multicityContainer">multi-city</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      // Tab functionality
      document.addEventListener("DOMContentLoaded", function () {
        const tabItems = document.querySelectorAll(".ms_tab_item");
        const tabContents = document.querySelectorAll(".ms_tab_cnt_item");

        // Get data from sessionStorage
        const storeData = JSON.parse(
          sessionStorage.getItem("storeData") || "{}"
        );
        const way = storeData.way;

        // Function to format date (DD MMM YYYY) without timezone conversion
        function formatDate(dateString) {
          const [year, month, day] = dateString.split("-");
          const date = new Date(year, month - 1, day);
          const options = { day: "numeric", month: "short", year: "numeric" };
          return date.toLocaleDateString("en-GB", options);
        }

        // Display airport data based on way type
        if (way === "multi-city" && Array.isArray(storeData.formIdInput)) {
          // Multi-city: show latest flight in one way and round trip, all flights in multi-city
          const lastIndex = storeData.formIdInput.length - 1;

          // Show latest flight in one way tab
          const onewayContainer = document.getElementById("onewayContainer");
          onewayContainer.innerHTML = `<div class="flight-item mspop_oneway">
              <div class="mspop_cnt_box">
                <p>From</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299269ccb9fc2ec39c70ca_plan_icon1.png" alt="icon" />
                  </div>
                  <p class="owfaname">${storeData.formIdInput[lastIndex]}</p>
                  <p class="owfaid">${storeData.fromId[lastIndex]}</p>
                </div>
              </div>
              <div class="mspop_cnt_box">
                <p>To</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/692992693227baee55527900_plan_icon2.png" alt="icon" />
                  </div>
                  <p class="owtaname">${storeData.toIdInput[lastIndex]}</p>
                  <p class="owtaid">${storeData.toIdInput[lastIndex]}</p>
                </div>
              </div>
              <div class="mspop_cnt_box">
                <p>Date</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299366e47ff54456ae3b44_datems.png" alt="icon" />
                  </div>
                  <p class="owdateformated">${formatDate(
                    storeData.dateAsText[lastIndex]
                  )}</p>
                  <p class="owdateastext">${storeData.dateAsText[lastIndex]}</p>
                </div>
              </div>
              <div class="mspop_cnt_box">
                <p>pax</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/6929936640fd29b7b68bea70_paxms.png" alt="icon" />
                  </div>
                  <p class=owpax>${storeData.pax[lastIndex]} Passanger</p>
                </div>
              </div>
              <div class="search_flight">
                <button class="oneway_search_btn" type="button">Search</button>
              </div>
          </div>`;

          // Show latest flight in round trip tab
          const roundtripContainer =
            document.getElementById("roundtripContainer");
          roundtripContainer.innerHTML = `<div class="flight-item mspop_roundtrip">
            <div class="mspop_cnt_box">
                <p>From</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299269ccb9fc2ec39c70ca_plan_icon1.png" alt="icon" />
                  </div>
                  <p class="rwfaname">${storeData.formIdInput[lastIndex]}</p>
                  <p class="rwfaid">${storeData.fromId[lastIndex]}</p>
                </div>
              </div>
              <div class="mspop_cnt_box">
                <p>To</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/692992693227baee55527900_plan_icon2.png" alt="icon" />
                  </div>
                  <p class="rwtaname">${storeData.toIdInput[lastIndex]}</p>
                  <p class="rwtaid">${storeData.toId[lastIndex]}</p>
                </div>
              </div>
              <div class="mspop_cnt_box">
                <p>Date</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299366e47ff54456ae3b44_datems.png" alt="icon" />
                  </div>
                  <p class="rwdateformated">${formatDate(
                    storeData.dateAsText[lastIndex]
                  )}</p>
                  <p class="rwdateastex">${storeData.dateAsText[lastIndex]}</p>
                </div>
              </div>
              <div class="mspop_cnt_box">
                <p>pax</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/6929936640fd29b7b68bea70_paxms.png" alt="icon" />
                  </div>
                  <p class="rwpax">${storeData.pax[lastIndex]} Passanger</p>
                </div>
              </div>
              <div class="search_flight">
                <button class="round_search_btn" type="button">Search</button>
              </div>
          </div>`;

          // Show all flights in multi-city tab
          const multicityContainer =
            document.getElementById("multicityContainer");
          let htmlContent = "";
          storeData.formIdInput.forEach((formId, index) => {
            htmlContent += `<div class="multicity-item">
              <div class="mc_fl_heading">
                <div class="mcfl_heading_cross">
                  <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/6929904e2a85631be7392ee2_ms_cross.png" alt="icon" />
                </div>
                <p>Flight ${index + 1}</p>
              </div>
              <div class="mcfl_box">
                <div class="mspop_cnt_box">
                <p>From</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299269ccb9fc2ec39c70ca_plan_icon1.png" alt="icon" />
                  </div>
                  <p class="mcfaname">${formId}</p>
                  <p class="mcfaid">${storeData.fromId[index]}</p>
                </div>
              <div class="mspop_cnt_box">
                <p>To</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/692992693227baee55527900_plan_icon2.png" alt="icon" />
                  </div>
                  <p class="mctaname">${storeData.toIdInput[index]}</p>
                  <p class="mctaid">${storeData.toId[index]}</p>
                </div>
              </div>
              <div class="mspop_cnt_box">
                <p>Date</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299366e47ff54456ae3b44_datems.png" alt="icon" />
                  </div>
                  <p class="mcdateformated">${formatDate(
                    storeData.dateAsText[index]
                  )}</p>
                  <p class="mcdateastext">${storeData.dateAsText[index]}</p>
                </div>
              </div>
              <div class="mspop_cnt_box">
                <p>pax</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/6929936640fd29b7b68bea70_paxms.png" alt="icon" />
                  </div>
                  <p class="mcpax">${storeData.pax[index]} Passanger</p>
                </div>
              </div>              
              </div>              
            </div>`;
          });
          multicityContainer.innerHTML = htmlContent;
          multicityContainer.innerHTML += `<div class="search_flight">
            <button class="multicity_btn" type="button">Search</button>
          </div>`;
        } else if (storeData.formIdInput && storeData.toIdInput) {
          // One way or Round trip: show same data in all tabs
          const flightHTML = `<div class="flight-item">
            <div class="mspop_cnt_box">
                <p>From</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299269ccb9fc2ec39c70ca_plan_icon1.png" alt="icon" />
                  </div>
                  <p>${storeData.formIdInput}</p>
                  
                </div>
              </div>
              <div class="mspop_cnt_box">
                <p>To</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/692992693227baee55527900_plan_icon2.png" alt="icon" />
                  </div>
                  <p>${storeData.toIdInput}</p>
                </div>
              </div>
              <div class="mspop_cnt_box">
                <p>Date</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299366e47ff54456ae3b44_datems.png" alt="icon" />
                  </div>
                  <p>${formatDate(storeData.dateAsText)}</p>
                </div>
              </div>
              <div class="mspop_cnt_box">
                <p>pax</p>
                <div class="mspop_cnt_item">
                  <div class="mspop_cnt_item_icon">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/6929936640fd29b7b68bea70_paxms.png" alt="icon" />
                  </div>
                  <p>${storeData.pax} Passanger</p>
                </div>
              </div>          
          </div>`;

          // For multi-city display, generate Flight 1, Flight 2, etc. based on available data
          let multicityHTML = "";
          if (Array.isArray(storeData.formIdInput)) {
            // If data is array format, show each flight
            storeData.formIdInput.forEach((formId, index) => {
              multicityHTML += `<div class="multicity-item">
                <div class="mc_fl_heading">
                  <div class="mcfl_heading_cross">
                    <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/6929904e2a85631be7392ee2_ms_cross.png" alt="icon" />
                  </div>
                  <p>Flight ${index + 1}</p>
                </div>
                <div class="mcfl_box">
                  <div class="mspop_cnt_box">
                    <p>From</p>
                    <div class="mspop_cnt_item">
                      <div class="mspop_cnt_item_icon">
                        <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299269ccb9fc2ec39c70ca_plan_icon1.png" alt="icon" />
                      </div>
                      <p>${formId}</p>
                    </div>
                  </div>
                  <div class="mspop_cnt_box">
                    <p>To</p>
                    <div class="mspop_cnt_item">
                      <div class="mspop_cnt_item_icon">
                        <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/692992693227baee55527900_plan_icon2.png" alt="icon" />
                      </div>
                      <p>${storeData.toIdInput[index]}</p>
                    </div>
                  </div>
                  <div class="mspop_cnt_box">
                    <p>Date</p>
                    <div class="mspop_cnt_item">
                      <div class="mspop_cnt_item_icon">
                        <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299366e47ff54456ae3b44_datems.png" alt="icon" />
                      </div>
                      <p>${formatDate(storeData.dateAsText[index])}</p>
                    </div>
                  </div>
                  <div class="mspop_cnt_box">
                    <p>pax</p>
                    <div class="mspop_cnt_item">
                      <div class="mspop_cnt_item_icon">
                        <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/6929936640fd29b7b68bea70_paxms.png" alt="icon" />
                      </div>
                      <p>${storeData.pax[index]} Passanger</p>
                    </div>
                  </div>
                </div>
              </div>`;
            });
          } else {
            // Single flight format
            multicityHTML = `<div class="multicity-item">
              <div class="mc_fl_heading">
                <div class="mcfl_heading_cross">
                  <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/6929904e2a85631be7392ee2_ms_cross.png" alt="icon" />
                </div>
                <p>Flight 1</p>
              </div>
              <div class="mcfl_box">
                <div class="mspop_cnt_box">
                  <p>From</p>
                  <div class="mspop_cnt_item">
                    <div class="mspop_cnt_item_icon">
                      <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299269ccb9fc2ec39c70ca_plan_icon1.png" alt="icon" />
                    </div>
                    <p>${storeData.formIdInput}</p>
                  </div>
                </div>
                <div class="mspop_cnt_box">
                  <p>To</p>
                  <div class="mspop_cnt_item">
                    <div class="mspop_cnt_item_icon">
                      <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/692992693227baee55527900_plan_icon2.png" alt="icon" />
                    </div>
                    <p>${storeData.toIdInput}</p>
                  </div>
                </div>
                <div class="mspop_cnt_box">
                  <p>Date</p>
                  <div class="mspop_cnt_item">
                    <div class="mspop_cnt_item_icon">
                      <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/69299366e47ff54456ae3b44_datems.png" alt="icon" />
                    </div>
                    <p>${formatDate(storeData.dateAsText)}</p>
                  </div>
                </div>
                <div class="mspop_cnt_box">
                  <p>pax</p>
                  <div class="mspop_cnt_item">
                    <div class="mspop_cnt_item_icon">
                      <img src="https://cdn.prod.website-files.com/6713759f858863c516dbaa19/6929936640fd29b7b68bea70_paxms.png" alt="icon" />
                    </div>
                    <p>${storeData.pax} Passanger</p>
                  </div>
                </div>
              </div>
            </div>`;
          }

          document.getElementById("onewayContainer").innerHTML = flightHTML;
          document.getElementById("roundtripContainer").innerHTML = flightHTML;
          document.getElementById("multicityContainer").innerHTML =
            multicityHTML;
          document.getElementById(
            "multicityContainer"
          ).innerHTML += `<div class="search_flight">
            <button class="multicity_btn" type="button">Search</button>
          </div>`;
        }

        // Map way values to tab IDs
        const wayToTabId = {
          "one way": "mstaboneway",
          "round trip": "mstabroundtrip",
          "multi-city": "mstabmulticity",
        };

        // Determine which tab to activate
        let activeTabId = wayToTabId[way] || "mstaboneway"; // Default to one way

        // Set active tab based on sessionStorage
        tabItems.forEach((item) => {
          const itemId = item.getAttribute("data-item");
          if (itemId === activeTabId) {
            item.classList.add("active");
          }
        });

        tabContents.forEach((content) => {
          if (content.id === activeTabId) {
            content.classList.add("active");
          }
        });

        // Tab click functionality
        tabItems.forEach((tabItem) => {
          tabItem.addEventListener("click", function () {
            const targetId = this.getAttribute("data-item");

            // Remove active class from all tabs and contents
            tabItems.forEach((item) => item.classList.remove("active"));
            tabContents.forEach((content) =>
              content.classList.remove("active")
            );

            // Add active class to clicked tab
            this.classList.add("active");

            // Add active class to matching content
            const targetContent = document.getElementById(targetId);
            if (targetContent) {
              targetContent.classList.add("active");
            }
          });
        });
      });
    </script>
  </body>
</html>
